{% extends "base.html" %}

{% block media %}
    <style>
        #login-panel-2fa {
            position: relative;
            margin: 5em auto auto -10em;
            top: 40%;
            left: 50%;
        }

        #totp-token-container {
            margin: 0.5em 0;
        }

        #id_totp_token {
            width: 100%;
        }

        .totp-panel-message {
            width: 300px;
        }
    </style>
{% endblock %}

{% block body %}
    <div id="login-panel-2fa">
        <form action="" method="post" class="form-area">
            {% csrf_token %}
            {% if form.errors %}
                <div id="form-errors">
                    <p class="error">{{ ' '.join(form.non_field_errors()) }}</p>
                </div>
            {% endif %}

            {% if request.profile.is_totp_enabled %}
                <div><label class="inline-header grayed">{{ _('Enter the 6-digit code generated by your app:') }}</label></div>
                <div id="totp-token-container"><span class="fullwidth">{{ form.totp_token }}</span></div>
                <hr>
            {% endif %}
            {% if request.profile.is_webauthn_enabled %}
                {{ form.webauthn_response }}
                <button style="display: inline" id="use-webauthn">{{ _('Use security key') }}</button>
            {% endif %}
            {% if request.profile.is_totp_enabled %}
                <button style="float:right;" type="submit">{{ _('Login!') }}</button>
            {% endif %}
        </form>
        <p class="totp-panel-message">{{ _('If you lost your authentication device, please contact us at %(email)s.', email=SITE_ADMIN_EMAIL)|urlize }}</p>
    </div>
{% endblock %}
